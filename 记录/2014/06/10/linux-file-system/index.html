


<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
		<title>Linux文件系统的创建和挂载 | 微尘</title>

  		
		<meta name="description" content="">
        

	    <meta name="author" content="Liluo">
	
        <!-- syntax highlighting CSS -->
		<link rel="shortcut icon" href="/assets/imgs/favicon.ico" type="image/vnd.microsoft.icon">
        <!-- Custom CSS -->
		<link rel="stylesheet" href="/assets/themes/custom_me/css/cikonss.css"}}" />
        <link rel="stylesheet" href="/assets/themes/custom_me/css/main.css" type="text/css" media="all">
        <link rel="stylesheet" href="/assets/themes/custom_me/css/pygments.css" type="text/css" media="all">
        <link rel="stylesheet" href="/assets/themes/custom_me/css/jquery.mCustomScrollbar.min.css" type="text/css" media="all">`
        <link rel="stylesheet" href="/assets/themes/custom_me/css/bigfoot-number.css" type="text/css" media="all">

    </head>
    <body>
        <div id="all">
<!--            header start-->
            <div id="header">
                <div id="title">
                <h1 >
                    <a href="/">微尘<span class="title-tagline">---人生最美妙的风景就是内心的淡定和从容</span>
					</a>                     	   
				</h1>
                </div>
                <!--hr/ -->
                <div id="top-nav">
                    <ul>
					



    
  	
  
  
  
	  
	  			

  
	  
	  
  	 		
      		
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  

  
  		<li><a href="/pages/micro_say/2015.html">微尘</a></li>
  



					<li><a href="/pages/articles/index.html">文章</a></li>
					<li><a href="/pages/categories/index.html">分类</a></li>
					<li><a href="/pages/tags/index.html">标签</a></li>
					<li><a href="/rss.xml">rss订阅</a></li>
					</ul>   
                </div>
            </div> 
<!--            header end-->
            <!--hr /-->
            <div class="content">
                


<div class="page-header">
	<h1>Linux文件系统的创建和挂载 <small></small></h1>
	<div id="article_header">
		
		
		<div>
			<span>分类: </span>
			<a href="/pages/categories/index.html#记录-ref" class="tag">记录</a> 
			
				<span>标签: </span>
			
			
				<a href="/pages/tags/index.html#linux-ref" class="tag">linux</a>
    		
				<a href="/pages/tags/index.html#mount / umount-ref" class="tag">mount / umount</a>
    		
				<a href="/pages/tags/index.html#mkfs-ref" class="tag">mkfs</a>
    		
				<a href="/pages/tags/index.html#文件系统-ref" class="tag">文件系统</a>
    		
		</div>		
		<div>
			Last Modify in
			
			<span>2014-06-10</span>,
			
			published in <span>2014-06-10</span> 
			by <span> LiLuo</span>
		</div>

		
		
	</div>
</div>

<div id="page-content">
    
<h3 id="section">如果您想</h3>
<p>如果您想加载一个分区（文件系统）:<br />
首先您得确认文件系统的类型，然后才能挂载使用<br />
比如通过mount 加载，或者通过修改 /etc/fstab来开机自动加载</p>

<p>如果您想添加一个新的分区或者增加一个新的硬盘:<br />
您要通过分区工具(<code>fdisk</code>)来添加分区<br />
然后要创建分区的文件系统 (<code>mkfs</code>) 
然后才是挂载文件系统(mount)</p>

<h3 id="section-1">存储设备的分区</h3>
<p>存储设备主要是本地硬盘、移动硬盘<br />
由于磁盘很大并且为了满足我们各种需要，所以把硬盘分成若干个分区<br />
比如我们可以用这个分区来安装Linux系统，那个分区用来 安装Windows系统…</p>

<p>Linux中进行硬盘分区操作,可以使用fdisk</p>

<h3 id="section-2">文件系统</h3>
<p>对存储设备分区，这个新的分区还不能正常使用，我们需要对其格式化<br />
即存储设备的格式化就是建立文件系统的过程</p>

<p>Windows下的文件系统,熟知有NTFS, msdos …
Linux下的文件系统，熟知的有ext2、ext3、swap 交换分区… … <br />
U盘的文件系统，有FAT32, fat16 … 
还有一些咱们不熟悉的操作系统的文件系统等</p>

<p>我们通常使用文件系统格式化工具进行<em>文件系统的建立</em></p>

<h3 id="section-3">文件系统的建立</h3>

<p><code>mkfs</code>就是Linux下常用的建立文件系统的工具<br />
<code>mkfs.nefs</code>, <code>mkfs.vfat</code>, <code>mkfs.ext2</code>, <code>mkfs.ext3</code>, <code>mkfs.ext4</code>等工具，也是Linux下建立文件系统常用工具<br />
事实上，<code>mkfs</code>也是更具提供的格式化文件系统类型参数，来调用这些工具实现指定文件系统的建立</p>

<p><code>mkfs</code>的命令格式</p>

<pre><code>mkfs -t 文件系统类型 存储设备 
</code></pre>

<p>首先，查看Linux下所有分区，确定分区的存储设备</p>

<pre><code>$ sudo fdsik -l
Disk /dev/sda: 120.0 GB, 120034123776 bytes
255 heads, 63 sectors/track, 14593 cylinders, total 234441648 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disk identifier: &lt;0x000d9852&gt;	&lt;/0x000d9852&gt;

   Device Boot      Start         End      Blocks   Id  System
/dev/sda1            2048    15624191     7811072   82  Linux swap / Solaris
/dev/sda2   *    15624192   234440703   109408256   83  &lt;Linux&gt;	&lt;/Linux&gt;

Disk /dev/sdb: 500.1 GB, 500107862016 bytes
255 heads, 63 sectors/track, 60801 cylinders, total 976773168 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disk identifier: &lt;0x5be4a3f9&gt;	&lt;/0x5be4a3f9&gt;

   Device Boot      Start         End      Blocks   Id  System
/dev/sdb1   *        2048   409602047   204800000    7  HPFS/NTFS/exFAT
/dev/sdb2       409602048   593922047    92160000    7  HPFS/NTFS/exFAT
/dev/sdb3       593922048   778242047    92160000    7  HPFS/NTFS/exFAT
/dev/sdb4       778244094   976771071    99263489    5  Extended
Partition 4 does not start on physical sector boundary.
/dev/sdb5       778244096   797773823     9764864   82  Linux swap / Solaris
/dev/sdb6       797775872   976771071    89497600   83  &lt;Linux&gt;	&lt;/Linux&gt;

Disk /dev/sde: 16.4 GB, 16358768640 bytes
255 heads, 63 sectors/track, 1988 cylinders, total 31950720 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: &lt;0xcad4ebea&gt;	&lt;/0xcad4ebea&gt;

   Device Boot      Start         End      Blocks   Id  System
/dev/sde4   *          63    31950719    15975328+   c  W95 FAT32 (LBA)  
</code></pre>

<p><code>/dev/sde4</code>是我U盘，以此为实验<br />
接着，为存储设备重新建立文件系统，即格式化一个新的文件系统<br />
那么，建立ext4文件系统</p>

<pre><code>$ sudo mkfs -t ext4 /dev/sde4  
mke2fs 1.42.9 (4-Feb-2014)
Filesystem label=
OS type: Linux
Block size=4096 (log=2)
Fragment size=4096 (log=2)
Stride=0 blocks, Stripe width=0 blocks
999424 inodes, 3993832 blocks
199691 blocks (5.00%) reserved for the super user
First data block=0
Maximum filesystem blocks=4093640704
122 block groups
32768 blocks per group, 32768 fragments per group
8192 inodes per group
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208
 
Allocating group tables: done                            
Writing inode tables: done                            
Creating journal (32768 blocks): done
</code></pre>

<p>同样，我们使用下面这条命令，也可以达到一样的效果</p>

<pre><code>$ sudo mkfs.ext4 /dev/sde4  
</code></pre>

<h4 id="swap">关于swap分区</h4>
<p>创建此分区为swap 交换分区</p>

<pre><code>$ mkswap /dev/sda6
</code></pre>

<p>加载交换分区</p>

<pre><code>$ swapon /dev/sda6 
</code></pre>

<p>关闭交换分区</p>

<pre><code>$ swapoff /dev/sda6
</code></pre>

<p>查看交换分区</p>

<pre><code>$ swapon -s		或者  
$ cat /proc/swaps
</code></pre>

<p>可以考虑下下面这种情况:内存不足，swap交换分区爆满,您的硬盘不能再分区<br />
此时怎么办呢? 你可以创建一个swap文件,并把其当作格式化swap来使用</p>

<p>创建一个大小为512M 的swap 文件，在/tmp目录中</p>

<pre><code>$ dd if=/dev/zero of=/tmp/swap bs=1024 count=524288
$ mkswap /tmp/swap
$ swapon /tmp/swap
</code></pre>

<h3 id="section-4">文件系统的挂载</h3>
<p>当我们需要访问某个文件系统时，必须要进行文件系统的挂载<br />
挂载文件系统，目前有两种方法:<br />
1. 通过 mount 来挂载<br />
2. 通过/etc/fstab文件来开机自动挂载</p>

<h4 id="mount-">通过mount 来挂载磁盘分区（或存储设备）</h4>
<p>mount的命令格式:</p>

<pre><code>mount -t type device dir
</code></pre>

<p><code>参数说明:</code><br />
<strong>-t</strong> 指定文件系统的类型<br />
一般的情况下不必指定有时也能识加 <br />
<code>-t </code>后面是<code>type</code>,<code>type</code>是文件系统类型( ext3 、ext2 、reiserfs、vfat 、ntfs 等)<br />
如果你忘记了文件系统，<code>type</code>就是 <code>auto</code>；</p>

<p><em>需要注意的是:</em> mount挂载文件系统,当挂载目录在挂载文件系统之前有文件存在,挂载之后文件消失(实际存在，只是看不见),只能看见当前挂载文件系统下的文件;当然，在卸载后，则会恢复</p>

<p><strong>device</strong> 指存储设备<br />
比如/dev/hda1， /dev/sda1 ，cdrom 等… <br />
你可以通过<code>fdisk -l</code>查看存储设备<br />
一般的情况下光驱设备是/dev/cdrom ；<br />
软驱设备是/dev/fd0 ；<br />
硬盘及移动硬盘以 fdisk -l 的输出为准；</p>

<p><strong>dir</strong> 挂载点<br />
一般是个目录,这个目录通常被使用<code>chmod</code>改写权限为<code>777</code>，这样任何用户都能写入了<br />
假如<code>dir</code>为空，那么会自动寻找挂载点</p>

<h4 id="section-5">查看已挂载的分区</h4>
<ol>
  <li>
    <p>使用df</p>

    <pre><code> $ df -lh
</code></pre>
  </li>
  <li>
    <p>使用mount</p>

    <pre><code> $ mount
</code></pre>
  </li>
</ol>

<p>你也可以通过显示/proc/mounts 或 /etc/mtab 来查看类似信息</p>

<h4 id="etcfstab">通过/etc/fstab文件来开机自动挂载文件系统</h4>
<p>这个文件中存在的文件系统，是开机自动挂载<br />
因此，当我们需要开机挂载某些文件系统的话，就直接在此文件后面添加（当然，按照固定格式）</p>

<p>此文件每条记录的格式</p>

<pre><code>&lt;file system&gt;  &lt;mount point&gt; &lt;type&gt; &lt;options&gt; &lt;dump&gt;  &lt;pass&gt;  
</code></pre>

<p><code>一共6个字段:</code><br />
<code>file system</code>: 设备名，即文件系统，例如/dev/sda1<br />
<code>mount point</code>: 文件系统挂载点<br />
<code>type</code>: 文件系统类型<br />
<code>options</code>: mount挂载文件时，使用-o指定的选项,具体查阅man手册<br />
<code>dump</code>: 文件系统是否需要dump 备份，1是需要，0 是不需要<br />
<code>pass</code>: 是否在系统启动时，通过fsck磁盘检测工具来检查文件系统，1是需要，0是不需要，2是跳过</p>

<p>swap分区在fatab中:</p>

<pre><code>LABEL=SWAP-hda7 swap swap defaults 0 0
</code></pre>

<p>文件系统为/dev/sdd4,文件系统挂载点为~/mnt,文件系统类型vfat:</p>

<pre><code>/dev/sdd4 ~/mnt vfat defaults 0 0
</code></pre>

<h3 id="section-6">文件系统的卸载</h3>
<p>使用umount来卸载<br />
卸载一个已有文件系统时，指出挂载点或者设备名其中一个就足够了，没有必要&gt; 都指出</p>

<pre><code>$ sudo umount device	或者  
$ sudo umount dir
</code></pre>

<p><em>需要注意的是:</em><br />
1. 当一个文件系统被卸载之后，作为挂载点的目录下的那些文件会再次出现<br />
2. 如果您想卸载一个文件系统，而此时进程已打开了该文件系统上的文件，将会出现一个错误消息。<br />
3. 卸载文件系统之前，您应当确认没有进程正在该文件系统的文件上运行(<code>lsof -w device</code> 或者 <code>lsof -w dir</code>再或者<code>lsof -w single_file</code>)<br />
4. <code>umount</code>使用<code>-l</code>参数进行懒卸载(直接从文件系统树分离文件系统，然后，在文件系统空闲时，清理文件系统附加项)</p>

<h3 id="section-7">两个比较特殊的文件</h3>
<ul>
  <li>
    <p>/dev/null</p>

    <pre><code>  它是空设备，也称为位桶（bit bucket）。
  任何写入它的输出都会被抛弃。
  如果不想让消息以标准输出显示或写入文件，那么可以将消息重定向到位桶。
</code></pre>
  </li>
</ul>

<p>一般用于错误信息或者垃圾信息重定向<br />
* /dev/zero</p>

<pre><code>	该设备无穷尽地提供0  
	它可以用于向设备或文件写入字符串0。
</code></pre>

<p>一般用于初始化某个文件和分区,例如<code>dd if=/dev/zero of=/tmp/heihei</code></p>

<hr />

<h3 id="section-8">相关链接</h3>
<ul>
  <li><a href="http://os.51cto.com/art/201012/239233_all.htm" title="Linux文件系统的安装和卸载">《Linux文件系统的安装和卸载》</a></li>
  <li><a href="http://www.ibm.com/developerworks/cn/linux/l-lpic1-v3-104-1/" title="学习 Linux，101: 创建分区和文件系统">《学习 Linux，101: 创建分区和文件系统》</a></li>
</ul>

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/%E8%BD%AF%E4%BB%B6/2014/06/08/st2-some-usage" title="Sublime Text 2的使用">&larr;上一篇：Sublime Text 2的使用</a></li>
      
        <li class="archive"><a href="/pages/articles/index.html">所有文章</a></li>
      
        <li class="next"><a href="/%E8%AE%B0%E5%BD%95/2014/06/14/lamp-build" title="LAMP 环境搭建">下一篇：LAMP 环境搭建&rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'blog-mwumli';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>





 </div>


   
            </div>
            <hr />
            <div id="footer">
                <p>
                <span>&copy;2014 Liluo</span>
                </p>
            </div>
        </div>
		
		<!-- site top -->
		<div id="site-top"><a href="#" title="Return to Top"></a>TOP</div>

		


		<script src="/assets/themes/custom_me/js/jquery-2.1.3.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="/assets/themes/custom_me/js/jquery.zclip.js"></script>
		<script src="/assets/themes/custom_me/js/copy.js"></script>
		<script src="http://cdn.bootcss.com/underscore.js/1.8.3/underscore.js"></script>
		<script src="/assets/themes/custom_me/js/toc.js"></script>
		<script src="/assets/themes/custom_me/js/jquery.resizeEnd.js"></script>
		<script src="/assets/themes/custom_me/js/jquery.mCustomScrollbar.concat.min.js"></script>

		<script src="/assets/themes/custom_me/js/bigfoot.js"></script>
		<script type="text/javascript" charset="utf-8">
			$(document).ready(function(){
						
				addCopy("pre", "copy", "Copy");
				tocEffect();

				var bigfoot=$.bigfoot({
					preventPageScroll: true
					})

			})
		</script>	
 </div>
    </body>
</html>




