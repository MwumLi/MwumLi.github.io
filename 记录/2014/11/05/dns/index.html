

<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
		<title>简单的DNS讲解 | 微尘</title>

  		
		<meta name="description" content="">
        

	    <meta name="author" content="Liluo">
	
        <!-- syntax highlighting CSS -->
		
        <!-- Custom CSS -->
		<link rel="stylesheet" href="/assets/themes/custom_me/css/cikonss.css"}}" />
        <link rel="stylesheet" href="/assets/themes/custom_me/css/main.css" type="text/css" media="all">
        <link rel="stylesheet" href="/assets/themes/custom_me/css/pygments.css" type="text/css" media="all">
        <link rel="stylesheet" href="http://malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.min.css" type="text/css" media="all">
        <link rel="stylesheet" href="/assets/themes/custom_me/css/bigfoot-number.css" type="text/css" media="all">

    </head>
    <body>
        <div id="all">
<!--            header start-->
            <div id="header">
                <div id="title">
                <h1 >
                    <a href="/">微尘<span class="title-tagline">---人生最美妙的风景就是内心的淡定和从容</span>
					</a>                     	   
				</h1>
                </div>
                <!--hr/ -->
                <div id="top-nav">
                    <ul>
					



    
  	
  
  
  
	  
	  			

  
	  
	  
  	 		
      		
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  
	  
	  			

  

  
  		<li><a href="/pages/micro_say/2015.html">微尘</a></li>
  



					<li><a href="/pages/articles/index.html">文章</a></li>
					<li><a href="/pages/categories/index.html">分类</a></li>
					<li><a href="/pages/tags/index.html">标签</a></li>
					<li><a href="/rss.xml">rss订阅</a></li>
					</ul>   
                </div>
            </div> 
<!--            header end-->
            <!--hr /-->
            <div class="content">
                

<div class="page-header">
	<h1>简单的DNS讲解 <small></small></h1>
	<div id="article_header">
		
		
		<div><span>2014-11-05</span> | <span>发布:</span> Liluo | <span>分类: </span>
		<a href="/pages/categories/index.html#记录-ref">记录</a>&nbsp;&nbsp;&nbsp;&nbsp;
		| <span>标签: </span>
			
        	<a href="/pages/tags/index.html#DNS-ref">DNS</a>
    		
        	<a href="/pages/tags/index.html#web-ref">web</a>
    		
		</div>
		
		
	</div>
</div>

<div id="page-content">
    
<h3 id="dns">DNS是什么</h3>
<p>DNS，可以看作Domain Name Service，Domain Name Server, Domain Name System的缩写，网上也没有统一的解释,说明是哪一种的缩写,我们暂且先不管它</p>

<p>早期互联网的时代，我们使用IP地址访问网站<br />
由于IPV4(IPv6)地址的难以记忆，人们用了一种转换的思想:<code>使用人类容易记忆的名字来代替IP地址,然后通过某种服务把域名转化成IP</code>，这样，就可以实现精确的定位<br />
而这个名字就是域名,例如耳熟能详的百度首页<code>www.baidu.com</code>,我们学校的论坛<code>www.xiyoubbs.com</code><br />
这种服务就是域名解析服务，我们用来提供服务的服务器就被称作域名解析服务器</p>

<p>事实上,我们通常把域名服务，域名服务器都可以称作DNS，理解了域名解析服务的工作原理，就很容易明白我们交流，或者其他文献中简称DNS时，它所代表的真实含义<br />
#### DNS的两种查询方式<br />
分别是递归查询和迭代查询</p>

<p>所谓<em>递归查询</em>：如果目标DNS服务器无法解析某个主机名,则它将向其他DNS服务器继续查询，如此递归，知道获得结果并把结果返回给客户</p>

<p>所谓<em>迭代查询</em>：如果目标DNS服务器无法解析某个主机名，则它将已知道的其他DNS服务器的IP地址返回给客户端，以供客户端参考</p>

<p>一般默认都是递归查询</p>

<h3 id="linuxdns">Linux下的一些用于DNS查询的命令</h3>
<ul>
  <li>
    <p>ping命令，不仅可以判断网络是否畅通，还可以用域名ping外网时，查看域名对应的主机IP</p>

    <pre><code>  $ ping www.baidu.com
  PING www.a.shifen.com (61.135.169.125) 56(84) bytes of data.
  64 bytes from 61.135.169.125: icmp_seq=1 ttl=53 time=19.7 ms
  64 bytes from 61.135.169.125: icmp_seq=2 ttl=53 time=21.1 ms
  64 bytes from 61.135.169.125: icmp_seq=3 ttl=53 time=20.0 ms
  ...
</code></pre>
  </li>
  <li>
    <p>host命令,一个DNS查询工具</p>

    <pre><code>  $ host -t A www.baidu.com  
  www.baidu.com is an alias for www.a.shifen.com.
  www.a.shifen.com has address 61.135.169.121
  www.a.shifen.com has address 61.135.169.125  
</code></pre>
  </li>
</ul>

<h3 id="tcpdumpdns">使用tcpdump观察DNS通信过程</h3>
<p>tcpdump是Linux下的一个抓包工具<br />
(Linux下各种服务所对应的端口，可以在<code>/etc/services</code>看到)<br />
在一个终端A输入一下命令:</p>

<pre><code>$ sudo tcpdump -i wlan0 -nt port domain 
</code></pre>

<p>然后开启另一个终端B,输入一下命令</p>

<pre><code>$ host -t -A www.baidu.com  
</code></pre>

<p>可以在终端A下看到:</p>

<pre><code>IP 172.24.243.3.21645 &gt; 172.24.243.1.53: 18340+ A? www.baidu.com. (31)
IP 172.24.243.1.53 &gt; 172.24.243.3.21645: 18340 3/0/0 CNAME www.a.shifen.com., A 115.239.211.110, A 115.239.210.27 (138)
</code></pre>

<p>cpdump以“IP地址.端口号”的形式来描述通信的某一端；以“&gt;”表示数据传输的方向，“&gt;”前面是源端，后面是目的端。</p>

<p>目标端口53是DNS服务使用的端口</p>

<p>第一个数据包是我的机器(172.24.243.3)发送的DNS查询报文<br />
第二个数据包是服务器反馈的DNS应答报文</p>

<p>第一个数据包中，数值18340是DNS查询报文的标识值，因此该值也出现在DNS应答报文中。<br />
“+”表示启用递归查询标志。<br />
“A”表示使用A类型的查询方式。<br />
“www.baidu.com”则是DNS查询问题中的查询名。<br />
括号中的数值31是DNS查询报文的长度（以字节为单位）。</p>

<p>第二个数据包中，“3/0/0”表示该报文中包含3个应答资源记录、0个授权资源记录和0个额外信息记录。<br />
“CNAME www.a.shifen.com., A 115.239.211.110, A 115.239.210.27 (138)”则表示3个应答资源记录的内容。<br />
其中CNAME表示紧随其后的记录是机器的别名，A表示紧随其后的记录是IP地址。<br />
该应答报文的长度为138字节。</p>

<h3 id="dns-1">修改DNS</h3>
<p>我记得以前碰到过这样一见很诡异的事情：qq可以登录聊天，邮件客户端也可以正常工作，就唯独浏览器打不开网站页面</p>

<p>当时遇到的时候，感觉可诡异，后来才知道，原来是DNS挂了</p>

<p>我们通常上网都是直接通过网络运营商(电信，网通等)提供的网络，所以DNS也是自动获取，一定运行上的域名服务器出现了问题，那么我们也就不能正常访问网站</p>

<p>此时，我们就得修改DNS，著名的DNS有谷歌的:<code>8.8.8.8</code> 和 <code>8.8.4.4</code>   <br />
还有114DNS:<code>114.114.114.114</code>和<code>114.114.115.115</code>  <br />
这两个算是比较好记的</p>

<p>还有其他的请参考<a href="www.ip.cn/dns.html">公共DNS服务器</a></p>


    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/%E8%AE%B0%E5%BD%95/2014/09/28/compile-link" title="编译和连接">&larr;上一篇：编译和连接</a></li>
      
        <li class="archive"><a href="/pages/articles/index.html">所有文章</a></li>
      
        <li class="next"><a href="/%E8%AE%B0%E5%BD%95/2014/12/05/linux-masm-built" title="Linux下MASM汇编环境搭建">下一篇：Linux下MASM汇编环境搭建&rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


      <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'blog-mwumli'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    





 </div>


   
            </div>
            <hr />
            <div id="footer">
                <p>
                <span>&copy;2014 Liluo</span>
                </p>
            </div>
        </div>
		
		<!-- site top -->
		<div id="site-top"><a href="#" title="Return to Top"></a>TOP</div>

		


		<script src="http://code.jquery.com/jquery-2.1.3.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="/assets/themes/custom_me/js/jquery.zclip.js"></script>
		<script src="/assets/themes/custom_me/js/copy.js"></script>
		<script src="http://cdn.bootcss.com/underscore.js/1.8.3/underscore.js"></script>
		<script src="/assets/themes/custom_me/js/toc.js"></script>
		<script src="/assets/themes/custom_me/js/jquery.resizeEnd.js"></script>
		<script src="http://malihu.github.io/custom-scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>

		<script src="/assets/themes/custom_me/js/bigfoot.js"></script>
		<script type="text/javascript" charset="utf-8">
			$(document).ready(function(){
						
				addCopy("pre", "copy", "Copy");
				tocEffect();

				var bigfoot=$.bigfoot({
					preventPageScroll: true
					})

			})
		</script>	
    <hr>
    


      <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'blog-mwumli'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    





 </div>
    </body>
</html>




